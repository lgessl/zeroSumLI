context("Testing cross validation")

test_that( "cross validation okay",{

    x <- log2(exampleData$x)
    y <- exampleData$y

    set.seed(1)
    fi <- sample( rep( rep(1:10), length.out=nrow(x) ))
    A <- zeroSumCVFit( x, y, type="gaussian", foldid=fi, standardize=FALSE, cores=1 )
    B <- zeroSumCVFit( x, y, type="gaussianZS", foldid=fi, standardize=TRUE,  cores=4 )

    y <- exampleData$ylogistic

    C <- zeroSumCVFit( x, y, type="binomial", foldid=fi, standardize=FALSE )
    D <- zeroSumCVFit( x, y, type="binomial", foldid=fi, standardize=TRUE )

    refA <- structure(c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 55.2537762968751,
52.7424068889204, 50.3451830964494, 48.0569168250733, 45.8726557872998,
43.7876727847466, 41.7974554774933, 39.8976966184329, 38.0842847314872,
36.353295213511, 34.7009818406289, 33.1237686606227, 31.618242253821,
30.1811443457448, 28.8093647555187, 27.4999346647883, 26.2500201925749,
25.0569162621643, 23.9180407467538, 22.8309288811887, 21.7932279276948,
20.8026920840606, 19.8571776232514, 18.9546382539345, 18.0931206918766,
17.2707604326271, 16.4857777163404, 15.7364736760028, 15.0212266607281,
14.3384887261656, 13.6867822844245, 13.0646969062639, 12.4708862686288,
11.9040652409249, 11.3630071037267, 10.8465408938998, 10.3535488703915,
9.88296409520505, 9.4337681243223, 9.00498880357746, 8.59569816471196,
8.20501041705676, 7.8320800304958, 7.47609990556174, 7.13629962670364,
6.81194379494638, 6.50233043633323, 6.20678948270715, 5.92468132154301,
5.65539541169208, 5.39834896204309, 5.15298567024025, 4.91877451872837,
4.69520862551972, 4.48180414719518, 4.27809923176577, 4.08365301912819,
3.89804468695126, 3.72087253992818, 3.55175314042385, 3.39032047863541,
3.23622518047044, 3.08913375142822, 2.94872785484779, 2.81470362296072,
2.68677099925763, 2.56465311074514, 2.44808566873475, 2.3368163968667,
2.23060448513118, 2.12922006870493, 2.0324437304757, 1.9400660261776,
1.85188703110988, 1.76771590745801, 1.68737049128061, 1.61067689826863,
1.53746914742319, 1.46758880183799, 1.40088462580865, 1.33721225752693,
1.27643389665162, 1.21841800607966, 1.16303902727232, 1.11017710852028,
1.05971784555933, 1.01155203397566, 0.965575432864607, 0.921688539231493,
0.879796372646321, 0.839808269686226, 0.801637687720833, 0.765202017615882,
0.730422404949761, 0.69722357935602, 0.665533691622529, 0.635284158194738,
0.6064095127465, 0.578847264497226, 0.552537762968751, 503.310194783702,
484.118132674629, 466.631040467787, 450.697453336155, 436.17936217049,
422.951018210448, 410.897843868972, 399.915440316052, 389.908683226001,
380.790898856052, 372.483113319862, 364.913368553492, 358.016099049074,
351.731563957758, 346.00532964305, 340.787798202698, 336.033777875387,
323.905366698737, 308.175682775163, 293.843381019083, 277.664844675891,
260.540582779345, 244.937539522705, 230.720696914208, 217.766853314489,
205.947835150475, 195.169956339364, 185.349609137815, 175.527194337628,
166.165388739791, 157.635247437731, 149.862900363007, 142.781027180895,
136.328288093822, 130.448792562751, 125.091615210091, 119.69150495422,
114.179580616302, 109.157460093495, 104.581490991129, 100.41203837198,
96.6130353192281, 92.2839789089385, 87.5126232614241, 83.1646073152273,
79.2029705853109, 75.5932748501349, 72.3041425460564, 69.307319615671,
66.5767262391285, 64.0886029057929, 61.8216259208548, 59.7560409407416,
57.8738537912373, 55.9867405594696, 54.2333387092592, 52.6357105259996,
51.1799159470209, 49.8535454765155, 48.6450060790783, 47.5437411649898,
46.5403984872659, 45.6261899368635, 44.7931154004979, 43.9489151385322,
42.8701451526995, 41.8869998192745, 40.991144037333, 40.174924343234,
39.0047251023686, 37.2635069718049, 35.5714210385827, 34.0296304786618,
32.6247951799349, 31.3259811113489, 30.1392593239896, 29.057979205417,
28.0464977463391, 27.0951813827986, 26.2283545712886, 25.4053038328168,
24.639969376382, 23.9425488380879, 23.1250048698635, 22.1774584053621,
21.3140326177942, 20.52728286071, 19.8103967135093, 19.0854882552821,
18.4191653385831, 17.8120528220331, 17.2588743987465, 16.6663227025563,
16.0707482630521, 15.437703666274, 14.696582151013, 13.9659089285425,
13.2820063739673, 12.64081535723, 12.0566324354079, 510.263190910512,
505.053529420691, 498.465192693453, 489.704153916051, 475.372148972185,
459.794529927606, 445.584885165983, 432.622410231822, 420.796999760789,
410.008298494732, 400.164836534072, 391.183241347215, 382.98751972106,
375.508403442026, 368.682753048648, 362.419953746061, 356.103098262514,
348.11413045955, 338.549842189337, 327.277962397369, 314.492147292461,
301.738134161729, 290.467026497763, 279.870876578302, 270.126806551594,
258.499317581286, 248.524559054856, 239.893432884383, 232.237237381379,
225.148084790304, 218.729814510139, 212.955488536029, 207.732994841342,
202.753032796574, 197.313367956821, 191.967549631438, 187.01884641907,
182.357836120229, 178.069369678671, 174.24056905548, 170.713052820188,
167.443532532446, 164.37315482466, 161.444715505346, 158.442652760744,
154.89940831714, 151.102463164165, 147.078379134085, 143.088578723753,
139.437852291387, 136.125790289272, 133.094885970469, 130.314952328462,
127.764274260824, 125.414128771187, 123.366580397619, 121.441093057052,
119.638616255308, 118.030149611472, 116.386627103382, 114.370831807193,
113.191938951145, 112.259572794048, 111.707685570523, 111.255002495256,
110.911646256103, 110.626686238744, 110.404182478188, 110.151856107101,
109.710744318799, 109.276221430272, 108.756428282906, 108.036189723815,
106.908810707242, 105.209095722937, 102.759573857539, 100.451510824583,
98.5772659426872, 97.587941698717, 96.8770993987, 96.2489741881737,
95.5996159888074, 94.9355164353015, 94.3023470808353, 93.6629481651443,
92.9306466278826, 92.5681952199457, 92.3981651533655, 91.9678873945011,
91.4080067886164, 90.9849370500385, 90.5600276688445, 90.162922484281,
89.8366612399401, 89.7714371161286, 89.4797679814523, 89.4688765371355,
89.6267286828913, 89.7557541717041, 89.9436562939105, 73.2822310088985,
72.6589460639444, 72.0517495642638, 70.1306184817525, 67.9365281459944,
65.8961020056454, 64.2855234494721, 63.0443308748739, 62.1164011898222,
61.4506744799632, 61.0015826618408, 60.7291763424938, 60.5989903236017,
60.5817124129332, 60.6527253260219, 60.824183315139, 61.2801688548096,
62.0182132695944, 63.0367939192022, 63.4783571027246, 63.5301575655767,
63.3085745111194, 63.114633863674, 62.6165241279426, 62.1042822753522,
61.0448855940968, 60.2665920392878, 59.7208170020847, 59.2050209643675,
58.8215966662629, 58.5132397619099, 58.2617117308207, 58.0548461420878,
57.9428390289358, 57.476430273684, 56.6885155262517, 55.9691364060956,
55.3189511280476, 54.7484681144326, 54.2342438314659, 53.7744747826403,
53.367673197655, 53.0077117166449, 52.7103621012859, 52.488773885379,
51.8084033333486, 50.6706397671414, 49.5938460358384, 48.5570368715357,
47.5903895927506, 46.6764780211537, 45.8185414093567, 45.0132203235288,
44.2568327299363, 43.5518310875954, 42.8752244616914, 42.2441450593165,
41.6551066590148, 41.0946651594655, 40.3074499654645, 39.0833993834931,
37.8777745797235, 36.7656643986313, 35.769919895692, 34.8512067861594,
33.9964929579144, 33.2151497211254, 32.5013559996238, 31.8689763604898,
31.3541795653441, 30.8959273171067, 30.5137978136579, 30.1572785262722,
29.835086377787, 29.4804548068065, 28.829708139436, 28.2234080707461,
27.6917821421449, 27.2661193358148, 26.8713930245285, 26.4148809622381,
25.835454179958, 25.1918669388114, 24.5375376590509, 24.0080311098554,
23.455227404891, 22.9062072276835, 22.374402445768, 21.9101777469565,
21.5650096943472, 21.2189293955832, 20.927153425651, 20.7091988171761,
20.4230167192974, 20.3125580693433, 20.3639650037715, 20.3608686420743,
20.342003623564, 20.3248097785129, 20.3049807762775, 0, 1, 1,
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 3, 3, 3, 3,
3, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 8, 8, 8,
8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 10,
10, 10, 10, 10, 11, 12, 12, 12, 12, 13, 13, 13, 14, 14, 14, 15,
15, 15, 16, 16, 16, 16, 16, 17, 17, 17, 17, 17, 18, 18, 19, 20,
21, 21, 21), .Dim = c(100L, 6L), .Dimnames = list(NULL, c("gamma",
"lambda", "training error", "CV error", "cv error sd", "non zero coefficients"
)))


    refB <- structure(c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 14.6735526047468, 14.0066169926072,
13.3699946333467, 12.7623077428381, 12.1822411593695, 11.6285394973584,
11.1000044304346, 10.5954920980109, 10.113910629729, 9.65421778242349,
9.21541868448958, 8.79656368277215, 8.3967462873177, 8.01510120954009,
7.65080248955489, 7.30306170862914, 6.97112628287808, 6.65427783451602,
6.35183063713632, 6.06313013165583, 5.78755150971194, 5.52449836144639,
5.27340138474949, 5.033717153171, 4.80492693983158, 4.5865355947891,
4.3780704734305, 4.17908041356983, 3.98913475903879, 3.80782242765655,
3.63475102156188, 3.46954597798192, 3.31184975859991, 3.16132107576741,
3.01763415388631, 2.88047802436222, 2.74955585260328, 2.62458429560798,
2.50529288875148, 2.3914234604436, 2.28272957339134, 2.17897599125703,
2.07993816955758, 1.98540176970323, 1.8951621951239, 1.80902414847937,
1.72680120899497, 1.64831542900794, 1.57339694885141, 1.50188362924256,
1.43362070037916, 1.36846042698538, 1.30626178858169, 1.24689017428698,
1.19021709149244, 1.13611988777665, 1.08448148546001, 1.03519012822419,
0.988139139247966, 0.9432266903363, 0.900355581542765, 0.859433030808514,
0.820370473162469, 0.783083369048174, 0.747491021362484, 0.713516400810137,
0.681085979196222, 0.650129570295768, 0.620580177956047, 0.592373851102871,
0.565449545337073, 0.539748990821638, 0.515216566173577, 0.491799178087598,
0.469446146431075, 0.448109094561628, 0.427741844629934, 0.408300317641189,
0.389742438058934, 0.372028042744776, 0.355118794036949, 0.338978096779581,
0.323571019123115, 0.308864216924466, 0.294825861583315, 0.281425571158349,
0.268634344614377, 0.256424499058017, 0.244769609826114, 503.310194783702,
474.126811318503, 444.329091041068, 415.2657053951, 388.78415498423,
364.655228859128, 340.986944859781, 318.427078720952, 297.871365205724,
279.141769820135, 260.931476165206, 244.222017909909, 228.99705153794,
215.124629216682, 202.484589305509, 190.96736796854, 180.473435314562,
170.911710167331, 162.199502700459, 154.261126611055, 147.028079375476,
140.437602183493, 132.565706626201, 125.321867731987, 118.79560578613,
112.70725436546, 106.343309502617, 100.161056029807, 94.5455803011525,
89.4289680837065, 84.6586558696185, 79.3979839143975, 74.5656084018553,
70.2006970661251, 66.3229957695878, 62.6315487853993, 59.3724911209864,
56.2919711301727, 53.555215665115, 51.0715543835442, 48.7757506490844,
46.6245569973793, 44.6597733781456, 42.7606053677905, 40.7508646035637,
38.9623571798729, 37.3337682890872, 35.8506266469593, 34.499246397502,
33.2678161725027, 32.1458818183034, 31.0888746118334, 29.7992075195815,
28.6152857126363, 27.5248935970909, 26.5303665071949, 25.3586201898653,
24.1407966919612, 23.0244245740022, 22.0072205220582, 21.0387053650555,
20.0945953972758, 19.2357727312854, 18.4533378901611, 17.7404179442041,
17.0868151547309, 16.4162045156591, 15.8058928176206, 15.249802930083,
14.7428545572718, 14.1591474553167, 13.5620453819076, 12.9966304485778,
12.4813892483738, 12.0193714257879, 11.5407202371883, 11.0675514440459,
10.6580097085744, 10.3420903966385, 10.0355332818801, 9.74435685811155,
9.43107824789115, 9.10530660152619, 8.80313750396273, 8.52778174908866,
8.27292233636132, 8.03346735072832, 7.81729746586533, 7.50329572298298,
542.439422039329, 527.685893871404, 511.666228630486, 493.520456526987,
474.872798914925, 456.883107699305, 437.244351383898, 416.515355631661,
396.377577147791, 376.410143294832, 357.821943987788, 340.483714135751,
324.58149398128, 310.162460264298, 297.460431511682, 286.175855993972,
275.911456909671, 267.661846363591, 260.463704727696, 253.965811614132,
247.412137458248, 241.035449342089, 234.662731267749, 228.810711750383,
223.265349372988, 217.795678025395, 212.237935709031, 207.268192304689,
202.819561245345, 198.2069486321, 191.544407064946, 185.120949926913,
179.402388665895, 173.942549997599, 168.500669263444, 163.619759842921,
159.055188617517, 154.782672695254, 150.873979430857, 147.328720474449,
144.085027213675, 141.168143056082, 138.49017410494, 136.043674411334,
133.725760768194, 130.691769507124, 127.655298188541, 124.638691181782,
121.57314432647, 118.967306990635, 116.701061290188, 114.97907619314,
113.990582078057, 113.208848300722, 112.622920637891, 111.820295652426,
110.723198313314, 109.469279698603, 108.298508052137, 107.012365973493,
105.300704720043, 103.317372796993, 101.294616640587, 99.2138877969901,
97.0898841380327, 95.5112743031268, 94.228299666587, 93.1442711596275,
92.2364772305663, 91.3855624103336, 90.7152296186947, 89.9681731850096,
89.4204886373321, 89.2849565420286, 89.2495586603108, 88.8455352505967,
88.4979728566953, 88.3668313580489, 88.403233712683, 88.639860809051,
88.9625937816617, 89.2911116218731, 89.6006326366895, 90.1480624931363,
90.6549486384262, 91.451481175332, 92.0791640803218, 92.4560695165702,
93.0747455447989, 79.3635304250149, 78.2811150382291, 77.6774700931296,
75.6996654853409, 73.0161631007441, 70.729215300951, 68.6714061368625,
67.052014820247, 65.8536186290302, 64.9110867894399, 64.2180884584705,
63.7565716828671, 63.449271221366, 63.2430992557858, 63.0844559190149,
62.9672648136973, 62.8987244813782, 62.7277131301286, 62.5635932581228,
62.4293897983806, 62.3968133257133, 62.4296964442025, 62.4662325438421,
62.5470829250447, 62.6816350306808, 62.7723580873226, 62.3014682372408,
61.8638302818299, 61.4809379321754, 61.0851577654278, 59.8405097785589,
58.7221151950226, 57.6453371806884, 56.6579821698551, 55.8222429628714,
55.0567901034286, 54.0116366721774, 52.9305657578054, 51.9266019329588,
50.983472837099, 50.1060498481756, 49.2772198175328, 48.5013227193297,
47.8360883034062, 47.2478516526888, 45.9878335408219, 44.5644788049657,
43.0458216964153, 41.43049117673, 39.8718135646118, 38.3987078379208,
37.0511562446197, 35.7852841009318, 34.5966654159669, 33.4937195936435,
32.5210460945119, 31.6133770519889, 30.8205224190245, 30.0959532897804,
29.3510365718415, 28.61491445398, 27.628387883865, 26.6574988453195,
25.7923628505542, 25.019260915467, 24.3436840251332, 23.7302831355284,
23.1948983528848, 22.7626201857823, 22.3687255329798, 22.0062583435633,
21.5892195514633, 21.2030300840627, 21.0212026349392, 20.9056707514666,
20.806691666364, 20.7647124339404, 20.6950458853661, 20.6280545258038,
20.6450100883376, 20.7563676231261, 20.8978976722753, 21.0398732267542,
21.2776379141717, 21.5733240946014, 22.0973167061191, 22.6974816450715,
23.1297351974099, 23.5160365818851, 0, 2, 3, 3, 3, 3, 4, 4, 4,
4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 8, 8, 8, 8,
9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 10, 10, 11, 10, 10, 10, 10,
10, 10, 10, 11, 11, 12, 12, 13, 14, 15, 15, 15, 16, 16, 16, 16,
16, 17, 17, 17, 17, 17, 18, 19, 19, 19, 18, 19, 19, 18, 18, 18,
18, 19, 20, 20, 20, 21, 21, 21, 22), .Dim = c(89L, 6L), .Dimnames = list(
    NULL, c("gamma", "lambda", "training error", "CV error",
    "cv error sd", "non zero coefficients")))



    refC <- structure(c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0.886765942301441, 0.846461061644117, 0.80798810001673,
0.771263793872097, 0.736208664119761, 0.702746844116588, 0.670805915475464,
0.640316751336733, 0.611213366763198, 0.583432775934894, 0.556914855834583,
0.531602216128949, 0.507440074963899, 0.484376140405155, 0.462360497267556,
0.441345499088144, 0.421285665009235, 0.402137581348319, 0.383859807641761,
0.366412786958952, 0.349758760292829, 0.333861684841476, 0.31868715600395,
0.30420233292152, 0.290375867403166, 0.277177836081534, 0.264579675652495,
0.252554121058178, 0.241075146479669, 0.230117909011694, 0.219658694897361,
0.209674868206629, 0.200144821847411, 0.191047930803304, 0.18236450749673,
0.174075759180899, 0.166163747268365, 0.158611348508164, 0.151402217927521,
0.144520753457894, 0.137952062168838, 0.131681928036581, -0.692626798987446,
-0.682721404048621, -0.673666054012147, -0.665370207711738, -0.657756201273101,
-0.650756941944018, -0.644314081402193, -0.638376556839908, -0.632899416863468,
-0.627842869925205, -0.623171508073123, -0.606506342863287, -0.590715860527327,
-0.576067585976687, -0.562447275382936, -0.549756656809375, -0.53791074972363,
-0.526835586646449, -0.51646641636004, -0.506746249948856, -0.497624674710956,
-0.489056879361442, -0.481002837992661, -0.472242911862307, -0.463546516819067,
-0.454703804441954, -0.446437722902921, -0.438705865362779, -0.431468795963586,
-0.424694205937909, -0.418349316054068, -0.412405371118558, -0.40683583487234,
-0.401071518070655, -0.394883114199761, -0.389055606938747, -0.38358605208877,
-0.378344614672777, -0.371713454276574, -0.365332245574533, -0.358998768526212,
-0.352893994863018, -0.734398218577282, -0.733982515115141, -0.733019319182782,
-0.727834816554674, -0.719466037289987, -0.710358246761898, -0.702039175185408,
-0.694431816254502, -0.688071667840583, -0.682531048755701, -0.677349703722223,
-0.670812437213264, -0.661009292459511, -0.646791258765467, -0.631840225491273,
-0.617423652373937, -0.604844126942574, -0.593938186462695, -0.58539121561272,
-0.578210976417547, -0.571885188295756, -0.566248176495755, -0.561627050726482,
-0.557552257910441, -0.55388640384713, -0.550371491351173, -0.547492147215515,
-0.545005756796296, -0.54289443882326, -0.541304955545613, -0.540936859321406,
-0.541660113994595, -0.542534116619386, -0.543542731238928, -0.544624598921523,
-0.546043357383477, -0.547692775706866, -0.549579912945764, -0.551017150973522,
-0.553945215322332, -0.55689371765672, -0.559785413467164, 0.0149792208339481,
0.0153073489684664, 0.0156330157076755, 0.0160241620335056, 0.0165005584484365,
0.016468444808991, 0.0170104821363247, 0.0179793423279261, 0.019229220950909,
0.0206777809849536, 0.0223923208781067, 0.0246567591434987, 0.0267035755960857,
0.0292568369238205, 0.0310234473564713, 0.0326738946913995, 0.0346149098259359,
0.0366078994012245, 0.0388702523221911, 0.0413060904757769, 0.0439443686290031,
0.0467185274467512, 0.0494709976350891, 0.052373259880597, 0.0553579032667526,
0.0582363468474025, 0.0611093792263468, 0.0639929016366145, 0.0669420124301255,
0.069919838484717, 0.0727861408595547, 0.075738896296791, 0.0788531554238947,
0.0820773207500557, 0.0854497348041154, 0.0888895912474781, 0.0923639101482069,
0.0958461727710353, 0.0989529420115576, 0.101830587833114, 0.104770122603738,
0.107840159762755, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2,
2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 6, 6,
5, 5, 7, 6, 7, 7, 7), .Dim = c(42L, 6L), .Dimnames = list(NULL,
    c("gamma", "lambda", "training error", "CV error", "cv error sd",
    "non zero coefficients")))


    refD <- structure(c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.306522485634539,
0.292590565594598, 0.279291872822137, 0.266597626160564, 0.254480352601275,
0.242913827826306, 0.231873019453419, 0.221334032860781, 0.211274059473998,
0.201671327403585, 0.192505054326036, 0.18375540250652, 0.175403435865873,
0.167431078998952, 0.159821078055675, 0.152556963400075, 0.145623013966557,
0.139004223236222, 0.132686266759613, 0.126655471155609, 0.120898784519364,
0.11540374817525, 0.110158469713676, 0.105151597253419, 0.100372294873778,
0.0958102191633712, 0.0914554968348281, 0.0872987033569264, 0.0833308425579334,
0.0795433271560055, 0.0759279601745124, 0.0724769172020621, 0.0691827294588359,
0.066038267632585, 0.0630367264493051, 0.0601716099451984, 0.057436717408047,
0.0548261299575732, 0.0523341977357426, 0.0499555276792884, 0.0476849718479922,
0.045517616283464, 0.0434487703743061, 0.0414739567046483, 0.0395889013640818,
0.0377895246980218, 0.036071932478481, 0.0344324074761439, 0.0328674014155046,
0.0313735272956549, 0.0299475520601053, 0.0285863895997734, 0.0272870940739976,
0.0260468535351207, 0.0248629838428463, -0.692626798987446, -0.675903701725744,
-0.660610491969752, -0.646583194224598, -0.633683524525284, -0.621793871613106,
-0.610813421093557, -0.600655128095003, -0.588475640996987, -0.574130921124493,
-0.55976824363738, -0.546396054378604, -0.533916188805666, -0.522244025532128,
-0.511306108561644, -0.500526126288632, -0.48791124427602, -0.475191255841196,
-0.463228028212671, -0.451959386939893, -0.441331940004284, -0.431298307994483,
-0.421814596928649, -0.412846735104858, -0.403961961798178, -0.395025065026748,
-0.386532802675064, -0.377870064174444, -0.368535118109448, -0.356711808417626,
-0.34517993378773, -0.334225351176542, -0.32401716007975, -0.315057049327921,
-0.305804230233999, -0.294954248446963, -0.284628781327175, -0.274783149933234,
-0.264828313370119, -0.255278126153453, -0.245936702802289, -0.236584278779433,
-0.227615090205638, -0.218994633272064, -0.21069827003492, -0.202705941372703,
-0.194997335222168, -0.187579474717564, -0.179984832260423, -0.172727776120298,
-0.165794111716409, -0.159164580450528, -0.152821551808611, -0.146748941498214,
-0.140932025196778, -0.732325881066308, -0.727653139151397, -0.719495205006244,
-0.705506992405805, -0.691652617079699, -0.679920441811058, -0.669390912446028,
-0.659580125194885, -0.650733463162099, -0.643570241930877, -0.637080270931106,
-0.632755733632078, -0.629308705512193, -0.625885147900112, -0.621297662606147,
-0.616785895271257, -0.612578379729613, -0.60759622087164, -0.601901046980611,
-0.5958758105714, -0.588206120319218, -0.580855236338289, -0.574529609374756,
-0.568974689114944, -0.564322032093082, -0.559568053675638, -0.555506447432344,
-0.551974091788804, -0.548534289511254, -0.54693997724017, -0.544610804943664,
-0.542285289928979, -0.540314524290144, -0.538643265897481, -0.537446872350594,
-0.53651756558681, -0.535131049471195, -0.534128973796826, -0.532187181840356,
-0.52935645847047, -0.527164740186502, -0.525466323676628, -0.524958633969882,
-0.524750252635855, -0.525806340832877, -0.528312934477609, -0.532872415413337,
-0.538005055302498, -0.54362465846548, -0.550813423590665, -0.559015520534085,
-0.566660869305593, -0.575316623808174, -0.58450109966136, -0.594019028419504,
0.0145288037460125, 0.0152655406188344, 0.0161873466490367, 0.0177496272256573,
0.0198119894120602, 0.0220769399321388, 0.024477975137439, 0.0268163285440352,
0.0290114906941791, 0.0307373292284811, 0.0325849082910702, 0.0344361223641407,
0.0365982817777131, 0.0391733242592659, 0.0418574402470954, 0.044563196998521,
0.0472670839617361, 0.0494343116492708, 0.0518540870909954, 0.0545881339064572,
0.0573325414540138, 0.0596870850436133, 0.0619227334516999, 0.0640712102934669,
0.0658433882646337, 0.0670099612871015, 0.0683211456432506, 0.0698004159232155,
0.071559489784037, 0.0731948852774446, 0.0748342775647555, 0.0767590450964922,
0.0787363667722604, 0.0808068976022143, 0.0829261775146869, 0.0850637375028577,
0.0872092984078073, 0.0896499605215444, 0.0919969002403293, 0.0934684266720324,
0.0946359786400061, 0.0959129642333166, 0.0971880782011216, 0.0979165823336392,
0.0989190160049394, 0.100157714033197, 0.101734720227666, 0.103424625335923,
0.105289915634776, 0.107613793578467, 0.110396514328155, 0.113423339089707,
0.116850797449103, 0.120625035810635, 0.125003335370493, 0, 1,
1, 1, 1, 1, 1, 1, 2, 3, 3, 3, 3, 3, 3, 4, 5, 5, 5, 5, 5, 5, 5,
5, 6, 6, 6, 7, 7, 9, 9, 9, 8, 8, 9, 9, 9, 9, 10, 10, 11, 11,
11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11), .Dim = c(55L,
6L), .Dimnames = list(NULL, c("gamma", "lambda", "training error",
"CV error", "cv error sd", "non zero coefficients")))

    expect_equal( as.numeric(refA[,2]) / as.numeric(A$cv_stats[,2]), rep(1,length(refA[,2])), tolerance=1e-3)
    expect_equal( as.numeric(refA[,3]) / as.numeric(A$cv_stats[,3]), rep(1,length(refA[,3])), tolerance=1e-3)
    expect_equal( as.numeric(refA[,4]) / as.numeric(A$cv_stats[,4]), rep(1,length(refA[,4])), tolerance=1e-3)
    expect_equal( as.numeric(refA[,5]) / as.numeric(A$cv_stats[,5]), rep(1,length(refA[,5])), tolerance=1e-3)

    expect_equal( as.numeric(refB[,2]) / as.numeric(B$cv_stats[,2]), rep(1,length(refB[,2])), tolerance=1e-3)
    expect_equal( as.numeric(refB[,3]) / as.numeric(B$cv_stats[,3]), rep(1,length(refB[,3])), tolerance=1e-3)
    expect_equal( as.numeric(refB[,4]) / as.numeric(B$cv_stats[,4]), rep(1,length(refB[,4])), tolerance=1e-3)
    expect_equal( as.numeric(refB[,5]) / as.numeric(B$cv_stats[,5]), rep(1,length(refB[,5])), tolerance=1e-3)

    expect_equal( as.numeric(refC[,2]) / as.numeric(C$cv_stats[,2]), rep(1,length(refC[,2])), tolerance=1e-3)
    expect_equal( as.numeric(refC[,3]) / as.numeric(C$cv_stats[,3]), rep(1,length(refC[,3])), tolerance=1e-3)
    expect_equal( as.numeric(refC[,4]) / as.numeric(C$cv_stats[,4]), rep(1,length(refC[,4])), tolerance=1e-3)
    expect_equal( as.numeric(refC[,5]) / as.numeric(C$cv_stats[,5]), rep(1,length(refC[,5])), tolerance=1e-3)

    expect_equal( as.numeric(refD[,2]) / as.numeric(D$cv_stats[,2]), rep(1,length(refD[,2])), tolerance=1e-3)
    expect_equal( as.numeric(refD[,3]) / as.numeric(D$cv_stats[,3]), rep(1,length(refD[,3])), tolerance=1e-3)
    expect_equal( as.numeric(refD[,4]) / as.numeric(D$cv_stats[,4]), rep(1,length(refD[,4])), tolerance=1e-3)
    expect_equal( as.numeric(refD[,5]) / as.numeric(D$cv_stats[,5]), rep(1,length(refD[,5])), tolerance=1e-3)

})
